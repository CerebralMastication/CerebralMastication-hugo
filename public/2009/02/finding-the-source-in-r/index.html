<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.51" />

  <title>Finding the Source in R &middot; Cerebral Mastication</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://cerebralmastication.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://cerebralmastication.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://cerebralmastication.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://cerebralmastication.com/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="http://cerebralmastication.com/css/my.css">
    
  
  
    
        <script src="http://cerebralmastication.com/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://cerebralmastication.com/">Blackburn</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://cerebralmastication.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://cerebralmastication.com/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://cerebralmastication.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/CMastication" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/jamesdlong" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/CerebralMastication" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/37751" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2018. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Finding the Source in R</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Feb 2009, 19:33</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://cerebralmastication.com/tags/r">R</a>
    
  </div>
  
  

</div>

  <p>Recently when reading the <a href="http://blog.revolution-computing.com/2009/02/finding-the-source.html">Revolutions R Blog </a>they talked about getting to the actual source of routines in R. They linked to an <a href="http://cran.r-project.org/doc/Rnews/Rnews_2006-4.pdf">R News PDF</a> from a couple years back. The actual text of the article is buried 43 pages into the PDF. To increase awareness and for my own future reference I&rsquo;m going to reprint Uwe Ligges&rsquo; article here.<!-- more --></p>

<blockquote>

> 
> # **Accessing the Sources**
> 
> 
by Uwe Ligges

> 
> ## Introduction
> 
> 
One of the major advantages of open source software such as R is implied by its name:  the sources are open (accessible) for everybody. There are many reasons to look at the sources. One example is that a user might want to know exactly what the software does, but the documentation is not sufficiently explicit about the underlying algorithm.
As another example, a user might want to change some code in order to implement a modification of a given (already implemented) method or in order to fix a bug in a contributed package or even in R itself.
How to access different kinds of sources (in order to read or to change them), both in R itself and in packages, is described in the following sections. It is always a good idea to look into appropriate manuals for your current R version, if working on the sources is required. Almost all manuals contain relevant information for this topic: ‘An  Introduction to R’, ‘Writing R Extensions’, ‘R Installation and Administration’, and ‘The R Language Definition’ (Venables et al., 2006; R Development Core Team, 2006a,b,c).

> 
> ## R Code Sources
> 
> 
In most cases, it is sufficient to read some R code of the function in question and look at how other functions are called or how the data are manipulated within a function. The fastest and easiest way to do so for simple functions is to type the function’s name into R and let R print the object. For example, here is how to view the source code for the  function
matrix():
> matrix
function (data = NA, nrow = 1, ncol = 1,
byrow = FALSE, dimnames = NULL)
{
data <- as.vector(data)
if (missing(nrow))
nrow <- ceiling(length(data)/ncol)
else if (missing(ncol))
ncol <- ceiling(length(data)/nrow)
x <- .Internal(matrix(data, nrow, ncol,
byrow))
dimnames(x) <- dimnames
x
}
<environment: namespace:base>
Unfortunately, comments in the code may have been removed from the printed output, because they were already removed in the loaded or installed package in order to save memory. This is in principle controlled by the arguments keep.source (for R) and keep.source.pkgs (for packages) of the options() function. If these arguments are set to TRUE comments are not removed, but there are also a lot of circumstances, e.g., lazy-loading and saved images of packages (Ripley, 2004), where setting these arguments to TRUE does not help to keep comments in the sources.
Therefore, it makes more sense to look into the original sources, i.e., those from which the package or R have been installed. Both R sources and sources of contributed packages are available from the CRAN mirrors (see http://cran.r-project.org/mirrors.html for a current list of mirrors).
After unpacking a source package, the R source code can be found in the directory PackageName/R/. Since the files therein are plain text files, they can be
opened in the user’s favorite text editor. For R’s base packages, the R code is available in R’s subdirectory $R_HOME/src/library/PakageName/R/. For package bundles, replace PackageName by BundleName/PackageName in the paths given above.

> 
> ## Code Hidden in a Namespace
> 
> 
In some cases, a seemingly missing function is called within another function. Such a function might simply be hidden in a namespace (Tierney, 2003). Type  getAnywhere("FunctionName") in order to find it. This function reports which namespace a function comes from, and one can then look into the sources of
the corresponding package. This is particularly true for S3 methods such as, for example, plot.factor:

R> plot.factor
Error: object "plot.factor" not found
R> getAnywhere("plot.factor")
A single object matching ’plot.factor’ was found
It was found in the following places
registered S3 method for plot from namespace
graphics
namespace:graphics
with value
### [function code omitted] ###
The file that contains the code of plot.factor is ‘$R HOME/src/library/graphics/R/plot.R’.

> 
> ## S3 and S4
> 
> 
As another example, suppose that we have the object lmObj, which results from a call to lm(), and we would like to find out what happens when the object is printed. In that case, a new user probably types R> print
in order to see the code for printing. The frustrating result of the call is simply:
function (x, ...)
UseMethod("print")
<environment: namespace:base>

The more experienced user knows a call to UseMethod() indicates that print() is an S3 generic and calls the specific method function that is appropriate for the object of class class(x). It is possible to ask for available methods with methods(print). The function of interest is the S3 method print.lm() from namespace stats (the generic itself is in the base package namespace). A method hidden in a namespace can be accessed (and therefore printed) directly using the ::: operator as in stats:::print.lm. The file containing the source code for printing the lmObj object is available from package stats’ sources:
‘$R HOME/src/library/stats/R/lm.R’. In order to understand and change S4 related
sources, it is highly advisable to work directly with a package’s source files. For a quick look, functions such as getClass(), getGeneric(), and getMethod() are available. The following example prints the code of the show() method for mle objects from the stats4 package:
R> library("stats4")
R> getMethod("show", "mle")

> 
> ## Compiled Code Sources
> 
> 
When looking at R source code, sometimes calls to one of the following functions show up: .C(), .Call(), .Fortran(), .External(), or .Internal() and .Primitive(). These functions are calling entry points in compiled code such as shared objects, static libraries or dynamic link libraries. Therefore, it is necessary to look into the sources of the compiled
code, if complete understanding of the code is required. In order to access the sources of compiled code (i.e., C, C++, or Fortran), it is not sufficient to have the binary version of R or a contributed package installed. Rather, it is necessary to download the sources for R or for the package. How to download those sources is described in the previous section. For contributed packages, source code can be found in the directory PackageName/src/ (again, for package bundles replace PackageName by BundleName/PackageName). Files therein can be searched for the corresponding entry point. For R and standard R packages, compiled code sources are in subdirectories of $R_HOME/src/. Particularly $R_HOME/src/main/ contains most of the interesting code. The first step is to look up the entry point in file ‘$R HOME/src/main/names.c’, if
the calling R function is either .Primitive() or .Internal(). This is done in the following example for the code implementing the ‘simple’ R function
sum().

Typing sum shows the R code of that function:
R> sum
function (..., na.rm = FALSE)
.Internal(sum(..., na.rm = na.rm))
<environment: namespace:base>

Obviously, there is only one relevant call within sum(), namely the .Internal call to an inner entry point sum(). The next step is to look up that entry point in the file ‘names.c’, which reveals the following line:
/* many lines omitted */
{"sum", do_summary, 0, 11, -1,
{PP_FUNCALL, PREC_FN, 0}},
/* many lines omitted */
This line tells us to look for do_summary which itself lives in file ‘summary.c’ in the same directory. If the filename is not obvious, then it can be found by simply ‘grep’ping for the string in R’s $R_HOME/src/ path.

> 
> ## The Bleeding Edge
> 
> 
Folks working on the bleeding edge of statistical computing might want to check out the most recent sources, e.g., by looking into the current svn archives of R. To access them via a web browser, visit https://svn.r-project.org/R/. The subdirectory ./trunk/ contains the current R-devel version; other branches (such as R-patched) can be found in ./ branches/, and released versions of R can be found in ./tags/.

> 
> ## Summary
> 
> 
It is easy to look at both R and C, C++ or Fortran sources. It is not that difficult to change the sources and to recompile or to reinstall a modified package. This way, users can become developers very easily and contribute bugfixes and new features to existing
packages or even to R itself.

> 
> ## Acknowledgments
> 
> 
I would like to thank Roger Bivand, Gabor
Grothendieck, Paul Murrell, and David Scott for suggestions
to improve this Help Desk article.
Bibliography
R Development Core Team. Writing R Extensions.
R Foundation for Statistical Computing, Vienna,
Austria, 2006a. URL [http://www.R-project.org](http://www.R-project.org).
R Development Core Team. R Installation and Administration.
R Foundation for Statistical Computing,
Vienna, Austria, 2006b. URL http://www.
R-project.org.
R Development Core Team. R Language Definition.
R Foundation for Statistical Computing, Vienna,
Austria, 2006c. URL http://www.R-project.org.
B. Ripley. Lazy Loading and Packages in R 2.0.0. R
News, 4(2):2–4, September 2004. ISSN 1609-3631.
URL http://CRAN.R-project.org/doc/Rnews/.
L. Tierney. Name Space Management for R. R News,
3(1):2–6, June 2003. ISSN 1609-3631. URL http:
//CRAN.R-project.org/doc/Rnews/.
W. N. Venables, D. M. Smith, and the R Development
Core Team. An Introduction to R. R Foundation for
Statistical Computing, Vienna, Austria, 2006. URL
http://www.R-project.org.
_Uwe Ligges_
Fachbereich Statistik, Universität Dortmund, Germany
ligges@statistik.uni-dortmund.de</blockquote>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://cerebralmastication.com/2009/02/data-its-currency/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://cerebralmastication.com/2009/02/data-its-currency/">Data... it&#39;s currency!</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://cerebralmastication.com/2009/02/annoying-security-paper-tiger-staplescom/">Annoying Security Paper Tiger - Staples.com</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://cerebralmastication.com/2009/02/annoying-security-paper-tiger-staplescom/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'cerebralmastication';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="http://cerebralmastication.com/js/ui.js"></script>
<script src="http://cerebralmastication.com/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-129487349-1', 'auto');
    ga('send', 'pageview');
  }
</script>





</body>
</html>

